Great â€” you want a **fresh new S3 bucket setup** for *profile pics & payslips* that will NEVER cause problems again.
I will give the FINAL, PERFECT, ZERO-ISSUE steps.
Just follow these exactly â€” step-by-step â€” and your uploads will work permanently.

---

# âœ… Step 1 â€” Create Bucket (VERY IMPORTANT SETTINGS)

âœ” Go to S3 â†’ Create bucket
âœ” Bucket name: `teamhub-files` (example)
âœ” Region: `us-east-1` (or same as your backend)
âœ” UNCHECK â— â€œBlock *all* public accessâ€
âœ” Confirm acknowledgement
âœ” Leave rest as default
âœ” Create bucket

**Why?**
Your app needs to serve images publicly.

---

# âœ… Step 2 â€” Create folder structure

Inside bucket:

```
teamhub-files
 â”œâ”€â”€ user_photos/
 â””â”€â”€ payslips/
```

**Donâ€™t change this later.**

---

# âœ… Step 3 â€” Set Bucket Policy (Public Read)

Go to:
S3 â†’ teamhub-files â†’ Permissions â†’ Bucket Policy

Paste:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicRead",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::teamhub-files/*"
    }
  ]
}
```

âœ” This allows your app & browser to READ files
ğŸš« No one can delete or upload except your backend

---

# âœ… Step 4 â€” CORS configuration (FINAL & CORRECT)

Go to:
S3 â†’ teamhub-files â†’ Permissions â†’ CORS

Paste EXACTLY this JSON:

```json
[
  {
    "AllowedHeaders": ["*"],
    "AllowedMethods": ["GET"],
    "AllowedOrigins": ["*"],
    "ExposeHeaders": []
  }
]
```

This ensures frontend can load images from S3.

---

# âœ… Step 5 â€” IAM Policy for your backend user

Your backend should use IAM with:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:PutObject",
        "s3:GetObject",
        "s3:DeleteObject"
      ],
      "Resource": "arn:aws:s3:::teamhub-files/*"
    },
    {
      "Effect": "Allow",
      "Action": [
        "s3:ListBucket"
      ],
      "Resource": "arn:aws:s3:::teamhub-files"
    }
  ]
}
```

âœ” backend can upload files
âœ” backend can list files
âœ” backend can delete files
âœ” frontend cannot upload/delete directly

---

# âœ… Step 6 â€” ALWAYS store full S3 URL in DB

Example:

```
https://teamhub-files.s3.amazonaws.com/user_photos/EMP001.png
```

or:

```
https://teamhub-files.s3.amazonaws.com/payslips/EMP001_2025-11.pdf
```

NOT:

```
user_photos/EMP001.png
```

NOT:

```
EMP001.png
```

Your frontend should use:

```html
<img src={profileImageUrl} />
```

---

# â— Step 7 â€” NEVER EVER touch these again

After setup DO NOT CHANGE:

â— bucket name
â— CORS JSON
â— bucket policy
â— permissions
â— region
â— folder names (`user_photos/`, `payslips/`)

---

# ğŸ§ª Step 8 â€” Test BEFORE integrating into UI

Upload one sample image to `user_photos/`
then open:

```
https://teamhub-files.s3.amazonaws.com/user_photos/test.png
```

If you see the image â†’ S3 is working correctly.

---

# ğŸ§  Step 9 â€” When uploading from backend

Use unique file names:

```
EMPID_timestamp.png
EMPID_MONTH_YEAR.pdf
```

This avoids overwriting.

---

# ğŸŒ Step 10 â€” Optional: Use CloudFront later (Best practice)

If later you want faster CDN:

```
https://cdn.teamhub.in/user_photos/EMP001.png
```

Then:
âœ” S3 stays private
âœ” CloudFront distributes
âœ” best performance
âœ” best security

(Future upgrade â€” not required now)

---

# ğŸ¯ Final Result

If you follow the above:

âœ” profile pics will always load
âœ” payslips will always load
âœ” no broken images
âœ” no CORS issues
âœ” no 403 errors
âœ” no AccessDenied
âœ” stable forever

---

# If you want â€” I can also provide:

âœ” Node.js S3 upload code
âœ” Java Spring Boot upload code
âœ” Express endpoint for file upload
âœ” React frontend upload
âœ” DB schema for storing URLs

Just tell me your backend language & tech stack.
